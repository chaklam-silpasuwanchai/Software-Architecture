<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Workshop 2. Continuous Testing and Integration | AIT SAD 2022</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/Software-Architecture/assets/css/0.styles.784d81f9.css" as="style"><link rel="preload" href="/Software-Architecture/assets/js/app.fadd9bf1.js" as="script"><link rel="preload" href="/Software-Architecture/assets/js/2.adb8ba43.js" as="script"><link rel="preload" href="/Software-Architecture/assets/js/6.93b796dd.js" as="script"><link rel="prefetch" href="/Software-Architecture/assets/js/10.2a1c9adb.js"><link rel="prefetch" href="/Software-Architecture/assets/js/11.6b027b6b.js"><link rel="prefetch" href="/Software-Architecture/assets/js/12.01a27dc9.js"><link rel="prefetch" href="/Software-Architecture/assets/js/13.e06db11d.js"><link rel="prefetch" href="/Software-Architecture/assets/js/14.2ac45b8d.js"><link rel="prefetch" href="/Software-Architecture/assets/js/15.3e03fbe3.js"><link rel="prefetch" href="/Software-Architecture/assets/js/16.0d44151e.js"><link rel="prefetch" href="/Software-Architecture/assets/js/17.bcd9ed45.js"><link rel="prefetch" href="/Software-Architecture/assets/js/18.089928bc.js"><link rel="prefetch" href="/Software-Architecture/assets/js/19.ae309c33.js"><link rel="prefetch" href="/Software-Architecture/assets/js/20.478c2c84.js"><link rel="prefetch" href="/Software-Architecture/assets/js/21.2c99f992.js"><link rel="prefetch" href="/Software-Architecture/assets/js/22.499ba438.js"><link rel="prefetch" href="/Software-Architecture/assets/js/23.7647f43c.js"><link rel="prefetch" href="/Software-Architecture/assets/js/24.48ee9543.js"><link rel="prefetch" href="/Software-Architecture/assets/js/25.5168a84a.js"><link rel="prefetch" href="/Software-Architecture/assets/js/26.d3dda84d.js"><link rel="prefetch" href="/Software-Architecture/assets/js/27.74e7f6e5.js"><link rel="prefetch" href="/Software-Architecture/assets/js/28.cd374eda.js"><link rel="prefetch" href="/Software-Architecture/assets/js/29.68183b40.js"><link rel="prefetch" href="/Software-Architecture/assets/js/3.d25d6a10.js"><link rel="prefetch" href="/Software-Architecture/assets/js/30.b16ae1cf.js"><link rel="prefetch" href="/Software-Architecture/assets/js/31.9fbfdc91.js"><link rel="prefetch" href="/Software-Architecture/assets/js/32.0d1047fa.js"><link rel="prefetch" href="/Software-Architecture/assets/js/33.92cf36fc.js"><link rel="prefetch" href="/Software-Architecture/assets/js/34.9e3f1c38.js"><link rel="prefetch" href="/Software-Architecture/assets/js/35.cc83d5b2.js"><link rel="prefetch" href="/Software-Architecture/assets/js/36.bd36fd89.js"><link rel="prefetch" href="/Software-Architecture/assets/js/37.574493e7.js"><link rel="prefetch" href="/Software-Architecture/assets/js/38.3657767e.js"><link rel="prefetch" href="/Software-Architecture/assets/js/39.2b91c1d2.js"><link rel="prefetch" href="/Software-Architecture/assets/js/4.4392ae1e.js"><link rel="prefetch" href="/Software-Architecture/assets/js/40.88c3551a.js"><link rel="prefetch" href="/Software-Architecture/assets/js/41.84b52be1.js"><link rel="prefetch" href="/Software-Architecture/assets/js/42.fc223d6b.js"><link rel="prefetch" href="/Software-Architecture/assets/js/43.eaee8773.js"><link rel="prefetch" href="/Software-Architecture/assets/js/44.857d3e5b.js"><link rel="prefetch" href="/Software-Architecture/assets/js/5.42799c04.js"><link rel="prefetch" href="/Software-Architecture/assets/js/7.fb4f9539.js"><link rel="prefetch" href="/Software-Architecture/assets/js/8.b92eae54.js"><link rel="prefetch" href="/Software-Architecture/assets/js/9.e4370ef5.js">
    <link rel="stylesheet" href="/Software-Architecture/assets/css/0.styles.784d81f9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Software-Architecture/" class="home-link router-link-active"><!----> <span class="site-name">AIT SAD 2022</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/chaklam-silpasuwanchai/Software-Architecture" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://v1.vuepress.vuejs.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/chaklam-silpasuwanchai/Software-Architecture" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://v1.vuepress.vuejs.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="workshop-2-continuous-testing-and-integration"><a href="#workshop-2-continuous-testing-and-integration" class="header-anchor">#</a> Workshop 2. Continuous Testing and Integration</h1> <p></p><div class="table-of-contents"><ul><li><a href="#task-2-1-push-the-project-to-your-github-reposistory">Task 2-1. Push the project to your GitHub Reposistory</a></li><li><a href="#task-2-2-create-github-actions">Task 2-2. Create GitHub Actions</a></li><li><a href="#let-s-take-a-break-and-understand-github-actions">Let's take a break and understand GitHub Actions</a></li><li><a href="#task-2-3-continuous-integration-ci">Task 2-3. Continuous Integration (CI)</a><ul><li><a href="#approach-1-simple-integration">Approach 1: Simple Integration</a></li><li><a href="#approach-2-ok-i-will-just-use-docker">Approach 2: OK, I will just use Docker</a></li><li><a href="#approach-1-integration-with-matrix">Approach 1++: Integration with Matrix</a></li></ul></li></ul></div><p></p> <p>Now that we have an app and a test script, we can set the GitHub Actions to run the test everytime we done something.</p> <p><a href="https://docs.github.com/en/actions/managing-workflow-runs/disabling-and-enabling-a-workflow" target="_blank" rel="noopener noreferrer">Disable workflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="task-2-1-push-the-project-to-your-github-reposistory"><a href="#task-2-1-push-the-project-to-your-github-reposistory" class="header-anchor">#</a> Task 2-1. Push the project to your GitHub Reposistory</h2> <p>Well, you know the way. Here is my result.</p> <img src="/Software-Architecture/assets/img/lab9-github-result.e5ca5145.png"> <h2 id="task-2-2-create-github-actions"><a href="#task-2-2-create-github-actions" class="header-anchor">#</a> Task 2-2. Create GitHub Actions</h2> <p>GitHub will looks for any <code>*.yml</code> files in your <code>/.github/workflows/</code>.</p> <ol><li>Create a folder <code>/.github/workflows/</code></li></ol> <p>Current project tree</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>.
|--.github/
    |--workflows/
|--.git/
|--docs/
    |--tempProject/
        |--&lt;main site code&gt;
    |--manage.py
|--Dockerfile
|--docker-compose.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="2"><li>Create <code>1-myFirstScript.yml</code> in <code>workflows</code>.</li></ol> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> My First Script
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>push<span class="token punctuation">]</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">myOwnTestScript</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span><span class="token number">20.04</span>
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> pwd
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la with name ja
        <span class="token key atrule">run</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> run ls <span class="token punctuation">-</span>la with workingdir as /
        <span class="token key atrule">run</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la
        <span class="token key atrule">working-directory</span><span class="token punctuation">:</span> /
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> touch hija.txt
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ol start="3"><li><p><code>Commit</code> and <code>Push</code></p></li> <li><p>Observe your reposistory</p></li></ol> <img src="/Software-Architecture/assets/img/lab9-githubAction-1.a0bf8811.png"> <img src="/Software-Architecture/assets/img/lab9-githubAction-1-2.575d588e.png"> <h2 id="let-s-take-a-break-and-understand-github-actions"><a href="#let-s-take-a-break-and-understand-github-actions" class="header-anchor">#</a> Let's take a break and understand GitHub Actions</h2> <blockquote><p><a href="https://docs.github.com/en/actions/learn-github-actions/understanding-github-actions" target="_blank" rel="noopener noreferrer">Understanding GitHub Actions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>You can configure a GitHub Actions workflow to be triggered when an event occurs in your repository, such as a pull request being opened or an issue being created. Your workflow contains one or more jobs which can run in sequential order or in parallel. Each job will run inside its own virtual machine runner, or inside a container, and has one or more steps that either run a script that you define or run an action, which is a reusable extension that can simplify your workflow.</p> <img src="https://docs.github.com/assets/cb-25535/images/help/images/overview-actions-simple.png"></blockquote> <p>This is our workflow -&gt; <code>1-myFirstScript.yml</code></p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> My First Script <span class="token comment"># This is the name of the workflow</span>
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>push<span class="token punctuation">]</span> <span class="token comment"># This is the event. It is an array so there could be multiple events</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span> <span class="token comment"># Here we define set of jobs</span>
  <span class="token key atrule">myOwnTestScript</span><span class="token punctuation">:</span> <span class="token comment"># Job#1 has a name of `myOwnTestScript`</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span><span class="token number">20.04</span> <span class="token comment"># Job#1.runs-on define which OS environment to run</span>
    <span class="token key atrule">steps</span><span class="token punctuation">:</span> <span class="token comment"># Job#1.steps is a list of things to do</span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> pwd <span class="token comment"># Job#1.steps[0] </span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la <span class="token comment"># Job#1.steps[1]</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la with name ja <span class="token comment"># Job#1.steps[2]</span>
        <span class="token key atrule">run</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> run ls <span class="token punctuation">-</span>la with workingdir as / <span class="token comment"># Job#1.steps[3]</span>
        <span class="token key atrule">run</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la
        <span class="token key atrule">working-directory</span><span class="token punctuation">:</span> /
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> touch hija.txt <span class="token comment"># Job#1.steps[4]</span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la <span class="token comment"># Job#1.steps[5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>In one sense, GitHub Actions creates a container based on <code>runs-on</code> argument and execute the list of steps in sequence. As you can see, for now, the script contain normal Terminal command.</p> <ol start="3"><li>Create <code>2-GitHubActions.yml</code> in <code>workflows</code>.</li></ol> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> 2<span class="token punctuation">-</span>GitHubAction.yml
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>push<span class="token punctuation">]</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">integration</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span><span class="token number">20.04</span>
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> echo &quot;Hi there everyone&quot;
      <span class="token comment"># https://github.com/actions/checkout</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2 <span class="token comment"># Here we `uses` instead of `run`</span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">ref</span><span class="token punctuation">:</span> master
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> ls <span class="token punctuation">-</span>la
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Aside from <code>run</code> that can execute Terminal command, <code>uses</code> runs <code>actions</code> .</p> <blockquote><p>An action is a custom application for the GitHub Actions platform that performs a complex but frequently repeated task. Use an action to help reduce the amount of repetitive code that you write in your workflow files. An action can pull your git repository from GitHub, set up the correct toolchain for your build environment, or set up the authentication to your cloud provider.</p> <p>You can write your own actions, or you can find actions to use in your workflows in the GitHub Marketplace.</p> <p>For more information, see &quot;<a href="https://docs.github.com/en/actions/creating-actions" target="_blank" rel="noopener noreferrer">Creating actions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.&quot;</p></blockquote> <p>In short, <code>actions</code> is a <code>function</code>. Someone create this function and you can use it. We will learn more about creating your own <code>actions</code> later on. For now, we learn how to use it.</p> <h2 id="task-2-3-continuous-integration-ci"><a href="#task-2-3-continuous-integration-ci" class="header-anchor">#</a> Task 2-3. Continuous Integration (CI)</h2> <p>Before we jump right into the implementation, let's think about how would this tool makes sense.</p> <p>We have a Django project and we want to test this project. Previously, we test the project using Unit Test library on our machine (Dev Stage). We done the development in a container environment. Thus, we control the environment.</p> <p>If we set the <code>workflow</code> environment to be the same as your container (install the same python version and same list of library + version), will this ensure that it will also works in your server (Production Stage)?</p> <p>Now that I make you confuse, I will show you various way we could do this.</p> <h3 id="approach-1-simple-integration"><a href="#approach-1-simple-integration" class="header-anchor">#</a> Approach 1: Simple Integration</h3> <p><code>3-simpleCI.yml</code></p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> 3<span class="token punctuation">-</span>simpleCI
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>push<span class="token punctuation">]</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">integration</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span><span class="token number">20.04</span>
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Clone Reposistory
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set up Python 3.10.2
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>python@v2
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">python-version</span><span class="token punctuation">:</span> 3.10.2
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install pip
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
          python3 -m pip install --upgrade pip
          pip3 install django==4.0.2
          pip3 install gunicorn==20.1.0</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Automate test
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
          python3 manage.py test</span>
        <span class="token key atrule">working-directory</span><span class="token punctuation">:</span> ./docs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="approach-2-ok-i-will-just-use-docker"><a href="#approach-2-ok-i-will-just-use-docker" class="header-anchor">#</a> Approach 2: OK, I will just use Docker</h3> <p><code>4-simpleCI-with-docker.yml</code></p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> 4<span class="token punctuation">-</span>simpleCI<span class="token punctuation">-</span>with<span class="token punctuation">-</span>docker
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>push<span class="token punctuation">]</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">integration</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span><span class="token number">20.04</span>
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Clone Reposistory
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Create Docker
        <span class="token key atrule">run</span><span class="token punctuation">:</span> docker<span class="token punctuation">-</span>compose up <span class="token punctuation">-</span><span class="token punctuation">-</span>build <span class="token punctuation">-</span>d
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Automate test
        <span class="token key atrule">run</span><span class="token punctuation">:</span> docker<span class="token punctuation">-</span>compose exec django python3 manage.py test
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Do you see any differences between the two methods? Surely, <code>Approach 2</code> is nearly the same as our Dev Stage with only difference is the Host machine is Ubuntu (if you are running Ubuntu 20.04 then it is completely the same, kind of). Is that the only difference?</p> <h3 id="approach-1-integration-with-matrix"><a href="#approach-1-integration-with-matrix" class="header-anchor">#</a> Approach 1++: Integration with Matrix</h3> <p><code>5-matrixCI.yml</code></p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> 5<span class="token punctuation">-</span>matrixCI
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>push<span class="token punctuation">]</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">integration</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span><span class="token number">20.04</span>
    <span class="token key atrule">strategy</span><span class="token punctuation">:</span>
      <span class="token comment"># if true, when job die, other will die. &quot;operation cancelled.&quot;</span>
      <span class="token key atrule">fail-fast</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
      <span class="token key atrule">matrix</span><span class="token punctuation">:</span>
        <span class="token key atrule">python-version</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3.6</span><span class="token punctuation">,</span> <span class="token number">3.7</span><span class="token punctuation">,</span> <span class="token number">3.8</span><span class="token punctuation">,</span> <span class="token number">3.9</span><span class="token punctuation">,</span> 3.10.2<span class="token punctuation">]</span>
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Clone Reposistory
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set up Python $<span class="token punctuation">{</span><span class="token punctuation">{</span> matrix.python<span class="token punctuation">-</span>version <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>python@v2
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">python-version</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> matrix.python<span class="token punctuation">-</span>version <span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install pip
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
          python3 -m pip install --upgrade pip
          pip3 install django==4.0.2
          pip3 install gunicorn==20.1.0</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Automate test
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
          python3 manage.py test</span>
        <span class="token key atrule">working-directory</span><span class="token punctuation">:</span> ./docs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>This way, we could ensure that our code works on multiple version of python. Fancy stuff. You can see that if we want to achieve <code>Approach 2++</code> we would need to prepare multiple Dockerfile for each python version we want to test.</p> <p>OK. So. Which one do we use? The first or the second one?</p> <p>Well, that is depens on you. The answer could be any or neither. What do you need to achieve from this automation? If you only want to run test script as frequent as possible then both approachs would get the job done. But if you want to ensure that your code will work once deploy to the production, both approachs might not do that for you.</p> <p>Let me reiterate the sentence.</p> <blockquote><p><strong>me from 10 minutes ago</strong></p> <p>Before we jump right into the implementation, let's think about how would this tool makes sense.</p></blockquote> <div class="page-nav"><p class="inner"><span class="prev"> 
        ←
        <a href="./ws1.html">Workshop 1 - Django Unit Test</a></span> <span class="next"><a href="./ws3.html">Workshop 3 - Automate Deploy</a>
        →
    </span></p></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/Software-Architecture/assets/js/app.fadd9bf1.js" defer></script><script src="/Software-Architecture/assets/js/2.adb8ba43.js" defer></script><script src="/Software-Architecture/assets/js/6.93b796dd.js" defer></script>
  </body>
</html>
